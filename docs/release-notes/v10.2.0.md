# v10.2.0 - Method Overloads & Delegate-Based Callbacks

**Release Date:** 2026-01-01
**NuGet:** [KnockOff 10.2.0](https://nuget.org/packages/KnockOff/10.2.0)

## Overview

Major release adding method overload support and switching to a delegate-based callback API. The `OnCall` property is now an `OnCall()` method that accepts a typed delegate.

## What's New

### Method Overloads Support

KnockOff now correctly handles interfaces with method overloads:

```csharp
public interface ICalculator
{
    int Add(int a, int b);
    int Add(int a, int b, int c);
    double Add(double a, double b);
}

[KnockOff]
public partial class CalculatorKnockOff : ICalculator { }
```

Each overload gets its own indexed callback method in the handler:

```csharp
knockOff.Spy.Add.OnCall0((ko, a, b) => a + b);           // int Add(int, int)
knockOff.Spy.Add.OnCall1((ko, a, b, c) => a + b + c);   // int Add(int, int, int)
knockOff.Spy.Add.OnCall2((ko, a, b) => a + b);          // double Add(double, double)
```

### Delegate-Based OnCall API

Callbacks now use typed delegates with individual parameters instead of tuples:

```csharp
// Old (v10.1.0 and earlier)
knockOff.Spy.Calculate.OnCall = (ko, args) => {
    var (name, value) = args;
    return value * 2;
};

// New (v10.2.0)
knockOff.Spy.Calculate.OnCall((ko, name, value) => value * 2);
```

## Breaking Changes

### OnCall is now a method, not a property

The `OnCall` property has been replaced with an `OnCall()` method:

```csharp
// Before (won't compile in v10.2.0)
knockOff.Spy.GetValue.OnCall = (ko, id) => id * 10;

// After
knockOff.Spy.GetValue.OnCall((ko, id) => id * 10);
```

### Parameters are individual, not tuples

Multi-parameter methods now receive individual parameters:

```csharp
// Before - tuple parameter
knockOff.Spy.Log.OnCall = (ko, args) => {
    var (level, message) = args;
};

// After - individual parameters
knockOff.Spy.Log.OnCall((ko, level, message) => {
    // level and message are direct parameters
});
```

## Bug Fixes

- Fixed callback method generation for non-overloaded methods (was generating `GetCallback0()` instead of `GetCallback()`)

## Migration Guide

1. **Replace property assignment with method call**:
   - Change `Spy.Method.OnCall = delegate` to `Spy.Method.OnCall(delegate)`

2. **Update tuple parameters to individual parameters**:
   - Change `(ko, args) => { var (a, b) = args; ... }` to `(ko, a, b) => { ... }`

3. **For method overloads**, use indexed methods:
   - `OnCall0()`, `OnCall1()`, `OnCall2()` for each overload by declaration order

---

**Full Changelog**: https://github.com/NeatooDotNet/KnockOff/compare/v10.1.0...v10.2.0
