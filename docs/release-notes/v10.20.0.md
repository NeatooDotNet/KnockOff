# v10.20.0 - Open Generic Delegate and Class Stubs

**Release Date:** 2026-01-15

## Summary

This release completes open generic inline stub support by adding delegates and classes to the existing interface support from v10.18.

## New Features

### Open Generic Delegate Stubs

Use `typeof()` with an unbound generic delegate:

```csharp
public delegate T Factory<T>();

[KnockOff(typeof(Factory<>))]
public partial class MyTests { }

// Use with any type argument:
var stringFactory = new Stubs.Factory<string>();
var intFactory = new Stubs.Factory<int>();

stringFactory.Interceptor.OnCall = (ko) => "hello";
Factory<string> factory = stringFactory;
Assert.Equal("hello", factory());
```

### Open Generic Class Stubs

Use `typeof()` with an unbound generic class:

```csharp
public abstract class Repository<T> where T : class
{
    public abstract T? GetById(int id);
}

[KnockOff(typeof(Repository<>))]
public partial class MyTests { }

// Use with any type argument:
var userRepo = new Stubs.Repository<User>();
userRepo.GetById.OnCall = (ko, id) => new User { Id = id };

Repository<User> repo = userRepo.Object;
var user = repo.GetById(42);
```

### Type Constraints Preserved

Both delegate and class stubs preserve type constraints:

```csharp
public delegate T Factory<T>() where T : new();

[KnockOff(typeof(Factory<>))]
public partial class MyTests { }

// Constraint enforced at compile time:
var stub = new Stubs.Factory<List<int>>();  // OK - List<int> has new()
// var stub = new Stubs.Factory<string>();  // Compile error - string has no new()
```

## Complete Open Generic Support Matrix

|  | **Standalone** | **Inline** |
|--|----------------|------------|
| **Interface** | ✅ v10.14 | ✅ v10.18 |
| **Class** | ❌ N/A | ✅ v10.20 |
| **Delegate** | ❌ N/A | ✅ v10.20 |

Note: Standalone open generic stubs for classes and delegates are not possible due to C# language constraints.

## Breaking Changes

None. This is a purely additive release.
