# v10.5.2 - Nested Class Support

**Release Date:** 2026-01-04
**NuGet:** [KnockOff 10.5.2](https://nuget.org/packages/KnockOff/10.5.2)

## Overview

Adds support for nested `[KnockOff]` classes, enabling better test organization by placing stubs inside test classes.

## New Feature

### Nested Class Support

KnockOff stubs can now be nested inside other classes, which is a common pattern for organizing test fixtures:

```csharp
public partial class UserServiceTests  // Must be partial!
{
    [KnockOff]
    public partial class RepositoryKnockOff : IRepository { }

    [Fact]
    public void GetUser_ReturnsUser()
    {
        var knockOff = new RepositoryKnockOff();
        IRepository repo = knockOff;
        // ... test code
    }
}
```

The generator now correctly wraps nested partial classes in their containing type hierarchy.

### Important Requirement

**All containing classes must be marked `partial`.** This is a C# language requirement—the generator produces partial class wrappers that must merge with your declarations.

```csharp
// Won't compile - containing class not partial
public class MyTests
{
    [KnockOff]
    public partial class ServiceKnockOff : IService { }
}

// Correct - containing class is partial
public partial class MyTests
{
    [KnockOff]
    public partial class ServiceKnockOff : IService { }
}
```

This works at any nesting depth—just ensure every class in the hierarchy is `partial`.

## Technical Details

- Generator captures containing type chain during transform phase
- Generated files use dot-separated names (e.g., `OuterClass.InnerKnockOff.g.cs`)
- Supports classes, records, and structs as containing types
- Preserves accessibility modifiers on containing type wrappers

---

**Full Changelog**: https://github.com/NeatooDotNet/KnockOff/compare/v10.5.1...v10.5.2
