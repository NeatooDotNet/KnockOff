# v10.4.1 - Bug Fixes

**Release Date:** 2026-01-02
**NuGet:** [KnockOff 10.4.1](https://nuget.org/packages/KnockOff/10.4.1)

## Overview

Bug fixes for nullable event handlers and collection property initializers.

## Bug Fixes

### Nullable Event Handler Syntax Error

Fixed double `??` syntax error when generating handlers for nullable event delegates.

**Before (broken):**
```csharp
private global::System.ComponentModel.PropertyChangedEventHandler?? _handler;  // CS1519
```

**After (fixed):**
```csharp
private global::System.ComponentModel.PropertyChangedEventHandler? _handler;
```

This affected interfaces with nullable event declarations like `INotifyPropertyChanged`.

### Collection Property Default Initializers

Non-nullable collection backing properties now generate with `Array.Empty<T>()` initializers to prevent CS8618 warnings.

**Before (broken):**
```csharp
protected IEnumerable<string> ModifiedPropertiesBacking { get; }  // CS8618
```

**After (fixed):**
```csharp
protected IEnumerable<string> ModifiedPropertiesBacking { get; } = Array.Empty<string>();
```

Applies to: `IEnumerable<T>`, `IReadOnlyCollection<T>`, `IReadOnlyList<T>`

## Neatoo Compatibility

These fixes, combined with Neatoo 10.2.0 (which removed internal interface members), enable full KnockOff support for Neatoo framework interfaces:

```csharp
[KnockOff]
public partial class EntityBaseStub : IEntityBase { }

// Configure behavior (v10.5.0+ syntax)
stub.IEntityBase.IsNew.OnGet = (ko) => true;
stub.IEntityBase.IsModified.OnGet = (ko) => true;
stub.IEntityBase.Save.OnCall = (ko) => Task.FromResult<IEntityBase>(ko);

// Verify calls
Assert.True(stub.IEntityBase.Delete.WasCalled);
```

Requires: **Neatoo 10.2.0+** and **KnockOff 10.5.0+**

---

**Full Changelog**: https://github.com/NeatooDotNet/KnockOff/compare/v10.4.0...v10.4.1
